<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../layouts/css/global.css" />
    <link rel="stylesheet" href="./dashboard.css" />
    <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
    <script type="module" src="../layouts/js/connectwallet.js " ></script>
    <script type="module" src="../layouts/js/sidebar.js"></script>
    <base href="../layouts/">
</head>
<body>
    <div data-include="../layouts/header.html"></div>

<!-- ini buat menampilkan data pribadi msg.sender, gauge harus active-->

<div class="background">

  <div class="dashboard-cards">

    <!-- PROFILE -->
    <div class="card profile-card">
      <div class="card-header">
        <div class="indicator green"></div>
        <h2>My Profile</h2>
      </div>
      <div class="profile-info">
        <p><span>Name:</span> John Doe</p>
        <p><span>GitHub:</span> johndev</p>
        <p><span>Age:</span> 21</p>
      </div>
    </div>


    <!-- STAT GAUGE -->
    <div class="card stats-card">
      <div class="card-header">
        <div class="indicator purple"></div>
        <h2>Task Progress</h2>
      </div>

      <div class="gauge-box"> <!-- Gauge is displaying reputation points -->
        <svg class="gauge-svg" viewBox="0 0 100 60">
          <defs>
            <linearGradient id="gStat" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#7c5cff"/>
              <stop offset="100%" stop-color="#ffffff"/>
            </linearGradient>
          </defs>
          <path class="g-track" d="M10 60 A40 40 0 0 1 90 60"/>
          <path class="g-progress" id="g-stat" d="M10 60 A40 40 0 0 1 90 60"/>
        </svg>

        <!-- JARUM -->
        <div class="needle" id="needle-stat"></div>
        <span class="g-value" id="statValue">1250</span>
      </div>

      <ul>
        <li>Completed: <span>28</span></li>
        <li>Failed: <span>3</span></li>
        <li>Reputation: <span>1250</span></li>
      </ul>
    </div>


    <!-- ACTIVE TASK -->
    <div class="card link-card open-panel" id="activePanel">
        <a href="./tasks/active.html">
      <div class="card-header">
        <div class="indicator blue"></div>
        <h2>Active Tasks</h2>
      </a>
      </div>

      <div class="gauge-box">
        <svg class="gauge-svg" viewBox="0 0 100 60">
          <defs>
            <linearGradient id="gActive" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#35d1ff"/>
              <stop offset="100%" stop-color="#ffffff"/>
            </linearGradient>
          </defs>
          <path class="g-track" d="M10 60 A40 40 0 0 1 90 60"/>
          <path class="g-progress" id="g-active" d="M10 60 A40 40 0 0 1 90 60"/>
        </svg>

        <div class="needle" id="needle-active"></div>
        <span class="g-value" id="activeValue">10</span>
      </div>
    </div>


    <!-- INACTIVE REDIRECT -->
    <div class="card link-card">
      <div class="card-header">
        <div class="indicator red"></div>
        <h2>Inactive Tasks</h2>
      </div>
      <p>See closed/idle tasks</p>
      <a href="./tasks/inactive.html" class="btn-card">View</a>
    </div>

  </div>

</div>










    <div data-include="../layouts/footer.html"></div>

    <script>
function updateGauge(gaugeId, needleId, percent){
  const path = document.getElementById(gaugeId);
  const needle = document.getElementById(needleId);

  const total = 126;
  path.style.strokeDashoffset = total - total * (percent/100);

  const angle = -90 + (percent * 1.8);
  needle.style.transform = `rotate(${angle}deg)`;
}

// demo
updateGauge("g-stat","needle-stat",65);
updateGauge("g-active","needle-active",45);

// toggle active panel
const panel = document.getElementById("activePanel");
panel.addEventListener("click",()=>{
  panel.classList.toggle("show");
});
</script>


    <script>
document.querySelectorAll("[data-include]").forEach(async el => {
    const file = el.getAttribute("data-include");
    const res = await fetch(file);
    el.innerHTML = await res.text();
});
</script>

</body>
</html>