<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../global/global.css" />
   <link rel="stylesheet" href="./dashboard.css" />
<script type="module" src="./dashboard.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.min.js"></script>
    <script type="module" src="../global/connectwallet.js " ></script>
    <script type="module" src="../global/sidebar.js"></script>
    <script type="module" src="./test.js"></script>
</head>
<body>
    <div data-include="../global/header.html"></div>

<!-- ini buat menampilkan data pribadi msg.sender, gauge harus active-->

<div class="background">

  <div class="dashboard-cards">

    <!-- PROFILE -->
    <div class="card profile-card">
      <div class="card-header">
        <div class="indicator green"></div>
        <h2>My Profile</h2>
      </div>
      <div class="profile-info">
        <button class="btn-caard" id="UnRegister">UnRegister</button>
        <p><span>Name:</span> <span id="name">-</span> </p>
        <p><span>GitHub:</span> <span id="github">-</span></p>
        <p><span>Age:</span> <span id="age">-</span></p>
        <p><span>Withdrawable:</span> <span id="withdrawable">-</span> <span>ETH</span></p>
      </div>
      <button class="btn-card" id="withdrawToMe">Withdraw To This Address</button>
      <button id="reload">Reload Data</button>
    </div>


    <!-- STAT GAUGE -->
    <div class="card stats-card">
      <div class="card-header">
        <div class="indicator purple"></div>
        <h2>Task Progress</h2>
      </div>

      <ul>
        <li>Created: <span id="created">-</span></li>
        <li>Completed: <span id="completed">-</span></li>
        <li>Failed: <span id="failed">-</span></li>
        <li>Reputation: <span id="reputation">-</span></li>
      </ul>
    </div>


    <!-- ACTIVE TASK -->
    <div class="card link-card open-panel" id="activePanel">
      <div class="card-header">
        <div class="indicator blue"></div>
        <h2>Active Tasks</h2>
      <a href="../task/task.html" class="btn-card">View</a>
      </div>

      <div class="gauge-box">
        <svg class="gauge-svg" viewBox="0 0 100 60">
          <defs>
            <linearGradient id="gActive" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#35d1ff"/>
              <stop offset="100%" stop-color="#ffffff"/>
            </linearGradient>
          </defs>
          <path class="g-track" d="M10 60 A40 40 0 0 1 90 60"/>
          <path class="g-progress" id="g-active" d="M10 60 A40 40 0 0 1 90 60"/>
        </svg>

        <div class="needle" id="needle-active"></div>
        <span class="g-value" id="activeValue">-</span>
      </div>
    </div>


  </div>

</div>


    <div data-include="../global/footer.html"></div>

    <script>
function updateGauge(gaugeId, needleId, percent){
  const path = document.getElementById(gaugeId);
  const needle = document.getElementById(needleId);

  const total = 126;
  path.style.strokeDashoffset = total - total * (percent/100);

  const angle = -90 + (percent * 1.8);
  needle.style.transform = `rotate(${angle}deg)`;
}

// demo
updateGauge("g-stat","needle-stat",65);
updateGauge("g-active","needle-active",45);

// toggle active panel
const panel = document.getElementById("activePanel");
panel.addEventListener("click",()=>{
  panel.classList.toggle("show");
});
</script>


    <script>
document.querySelectorAll("[data-include]").forEach(async el => {
    const file = el.getAttribute("data-include");
    const res = await fetch(file);
    el.innerHTML = await res.text();
});
</script>

</body>
</html>